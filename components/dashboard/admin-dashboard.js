import { Pie, Bar, Line, Doughnut } from 'react-chartjs-2';
import { Chart as ChartJS, ArcElement, Tooltip, Legend, Title, CategoryScale, LinearScale, BarElement, PointElement, LineElement } from 'chart.js';
import { useDispatch } from 'react-redux';
import { globalActions } from '../../store/globalSlice';
import { forwardRef, useEffect, useImperativeHandle, useState } from 'react';
import SelectFilterComponent from '../ui/select-filter';

ChartJS.register(ArcElement, Tooltip, Legend, Title, CategoryScale, LinearScale, BarElement, PointElement, LineElement);

const AdminDashboardPage = (props, ref) => {
    const dispatch = useDispatch();
    const [data, setData] = useState({
        totalBookingsYTD: 0,
        bookingLastQuarter: 0,
        bookingsLastMonth: 0,
        bookingsCanceledYTD: 0,
        leads: {
            zero19: 0,
            twenty39: 0,
            fourty59: 0,
            sixtyPlus: 0
        },
        bookings_versus_data: {
            labels: [],
            details: [],
        },
        bookings_status_data: {
            labels: [],
            details: [],
        }
    });


    useImperativeHandle(ref, () => ({
        reloadData() {
            fetchData();
        }
    }));

    const filters = [
        { label: 'Week', value: 'Week' },
        { label: 'Month', value: 'Month' },
        { label: 'Quarter', value: 'Quarter' },
        { label: 'Year', value: 'Year' }
    ];
    const [filterSelection, setFilterSelection] = useState('Year');

    const handleFilterSelection = (selected) => {
        setFilterSelection(selected.value);
    }

    const fetchData = async () => {
        dispatch(globalActions.setLoading(true));

        const response = await fetch("/api/bookings/dashboard/admin?filter=" +
            filterSelection, {
            method: "GET",
            headers: {
                "Content-Type": "application/json",
            },
        });
        dispatch(globalActions.setLoading(false));
        const data = await response.json();
        setData(data);


    }

    const lineChartData = {
        labels: data.bookings_versus_data.labels,
        datasets: [
            {
                label: data.bookings_versus_data?.details[0]?.label,
                data: data.bookings_versus_data?.details[0]?.data,
                fill: false,
                backgroundColor: "#ffbb00",
                borderColor: "#ffbb00",
                tension: 0.4
            },
            {
                label: data.bookings_versus_data?.details[1]?.label,
                data: data.bookings_versus_data?.details[1]?.data,
                backgroundColor: "#0288d1",
                borderColor: "#0288d1",
                fill: false,
                tension: 0.4
            }
        ]
    };

    const lineChartOptions = {
        responsive: true,
        plugins: {
            legend: {
                display: true,
                position: "bottom"
            },
        },
        maintainAspectRatio: false
    };

    const pieChartData = {
        labels: ['0-19 Days', '20-39 Days', '40-59 Days', '60+'],
        datasets: [
            {
                data: [data.leads.zero19, data.leads.twenty39, data.leads.fourty59, data.leads.sixtyPlus],
                backgroundColor: [
                    '#02ab92',
                    '#0288d1',
                    '#ffbb00',
                    '#ff5d5d'
                ],
                borderColor: [
                    '#02ab92',
                    '#0288d1',
                    '#ffbb00',
                    '#ff5d5d'
                ],
                borderWidth: 1,
            },
        ],
    };

    const pieChartOptions = {
        plugins: {
            legend: {
                display: false
            },
        },
    };

    const barChartData = {
        labels: data.bookings_status_data.labels,
        datasets: [
            {
                label: data.bookings_status_data?.details[0]?.label,
                data: data.bookings_status_data?.details[0]?.data,
                backgroundColor: '#ffbb00',
                barThickness: 15,
                order: 1
            },
            {
                label: data.bookings_status_data?.details[1]?.label,
                data: data.bookings_status_data?.details[1]?.data,
                backgroundColor: '#0288d1',
                barThickness: 15,
                order: 1
            },
            {
                label: data.bookings_status_data?.details[2]?.label,
                data: data.bookings_status_data?.details[2]?.data,
                backgroundColor: '#02ab92',
                barThickness: 15,
                order: 1
            },
        ],
    };

    const barCharOptions = {
        plugins: {
            title: {
                display: false,
            },
            legend: {
                display: true,
                position: "bottom"
            },
        },
        responsive: true,
        scales: {
            x: {
                stacked: false,
                grid: {
                    display: false
                },
            },
            y: {
                stacked: false,
                grid: {
                    display: false,
                },
            },
        },
        maintainAspectRatio: false
    };

    useEffect(() => {
        fetchData();
    }, [filterSelection]);

    return (
        <div className='my-2'>
            <div className='flex flex-wrap'>
                <div className="p-6 relative w-full md:w-1/2 lg:w-1/4">
                    <div className='absolute inset-1 bg-zinc-100 -z-20 rounded-md'></div>
                    <div className='absolute right-4 pr-2 -z-10'>
                        <svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M51.8458 58.4285H8.17638C6.03051 58.4355 3.96846 57.596 2.43772 56.0921C0.906971 54.5882 0.0310362 52.5414 0 50.3957V15.9606C0.0119344 14.8669 0.243853 13.7869 0.681941 12.7847C1.12003 11.7826 1.75533 10.8789 2.54999 10.1274C4.12698 8.66351 6.2096 7.86721 8.36096 7.90555C8.93945 7.92909 9.4859 8.17752 9.88397 8.59793C10.282 9.01834 10.5003 9.57753 10.4922 10.1564C10.481 10.7314 10.2433 11.2787 9.83076 11.6794C9.41823 12.0801 8.86424 12.3018 8.28918 12.2962H8.14733C7.17282 12.2979 6.23704 12.6779 5.53721 13.356C4.83737 14.0342 4.42816 14.9576 4.39583 15.9315V50.3684C4.41687 51.3484 4.82171 52.281 5.52328 52.9656C6.22484 53.6503 7.16708 54.0322 8.14733 54.0293H51.7006C52.706 54.0433 53.6796 53.677 54.4266 53.0038C54.7867 52.6698 55.0761 52.2668 55.2775 51.8187C55.4789 51.3707 55.5882 50.8868 55.599 50.3957V15.9606C55.5789 14.98 55.1744 14.0465 54.4728 13.3611C53.7711 12.6758 52.8284 12.2934 51.8475 12.2962H51.6766C51.0937 12.2962 50.5347 12.0647 50.1225 11.6525C49.7103 11.2403 49.4787 10.6813 49.4787 10.0983C49.4787 9.51541 49.7103 8.95636 50.1225 8.54417C50.5347 8.13198 51.0937 7.90042 51.6766 7.90042H51.8236C53.9691 7.89478 56.0304 8.73476 57.5608 10.2383C59.0913 11.7419 59.9676 13.788 60 15.9332V50.3684C59.9766 52.5139 59.108 54.5636 57.5826 56.0726C56.0573 57.5817 53.9983 58.4282 51.8527 58.4285H51.8458Z" fill="#E3E5E6" />
                            <path d="M13.9811 15.2569C13.4001 15.2506 12.8447 15.0171 12.4338 14.6062C12.023 14.1954 11.7894 13.6399 11.7832 13.0589V3.76823C11.7832 3.1853 12.0148 2.62626 12.427 2.21407C12.8391 1.80188 13.3982 1.57031 13.9811 1.57031C14.564 1.57031 15.1231 1.80188 15.5353 2.21407C15.9475 2.62626 16.179 3.1853 16.179 3.76823V13.0589C16.1728 13.6399 15.9392 14.1954 15.5284 14.6062C15.1176 15.0171 14.5621 15.2506 13.9811 15.2569Z" fill="#E3E5E6" />
                            <path d="M45.8678 15.2569C45.2868 15.2506 44.7314 15.0171 44.3206 14.6062C43.9097 14.1954 43.6761 13.6399 43.6699 13.0589V3.76823C43.6699 3.1853 43.9015 2.62626 44.3137 2.21407C44.7259 1.80188 45.2849 1.57031 45.8678 1.57031C46.4508 1.57031 47.0098 1.80188 47.422 2.21407C47.8342 2.62626 48.0658 3.1853 48.0658 3.76823V13.0589C48.0662 13.3477 48.0097 13.6337 47.8994 13.9006C47.7891 14.1675 47.6272 14.4099 47.423 14.6141C47.2188 14.8183 46.9763 14.9802 46.7095 15.0905C46.4426 15.2008 46.1566 15.2573 45.8678 15.2569Z" fill="#E3E5E6" />
                            <path d="M37.7193 12.2962H22.2741C21.6912 12.2962 21.1321 12.0647 20.7199 11.6525C20.3077 11.2403 20.0762 10.6812 20.0762 10.0983C20.0762 9.51538 20.3077 8.95633 20.7199 8.54415C21.1321 8.13196 21.6912 7.90039 22.2741 7.90039H37.7193C38.3022 7.90039 38.8613 8.13196 39.2735 8.54415C39.6857 8.95633 39.9172 9.51538 39.9172 10.0983C39.9172 10.6812 39.6857 11.2403 39.2735 11.6525C38.8613 12.0647 38.3022 12.2962 37.7193 12.2962Z" fill="#E3E5E6" />
                            <path d="M26.4774 45.2579C25.9466 45.2505 25.4343 45.0621 25.0251 44.724C24.5903 44.3359 24.3254 43.7925 24.2874 43.211C24.2495 42.6294 24.4416 42.0562 24.8223 41.615L40.5108 23.7349C40.7006 23.5154 40.9318 23.3357 41.1913 23.206C41.4508 23.0763 41.7333 22.9992 42.0227 22.9791C42.3121 22.9591 42.6026 22.9965 42.8775 23.0892C43.1524 23.1818 43.4062 23.328 43.6244 23.5191C43.8426 23.7103 44.0208 23.9428 44.1488 24.2031C44.2768 24.4634 44.352 24.7465 44.3701 25.036C44.3882 25.3256 44.3489 25.6158 44.2544 25.8901C44.1599 26.1643 44.0121 26.4172 43.8195 26.6341L28.1303 44.5203C27.922 44.7524 27.6672 44.938 27.3824 45.065C27.0976 45.1921 26.7893 45.2578 26.4774 45.2579Z" fill="#E3E5E6" />
                            <path d="M25.658 44.595C25.0766 44.5911 24.5204 44.3573 24.1108 43.9447L17.4485 37.2675C17.2395 37.0644 17.073 36.8218 16.9587 36.5536C16.8444 36.2855 16.7846 35.9973 16.7828 35.7059C16.781 35.4144 16.8372 35.1255 16.9482 34.856C17.0592 34.5865 17.2228 34.3418 17.4293 34.1362C17.6358 33.9305 17.8812 33.768 18.1512 33.6582C18.4211 33.5483 18.7103 33.4933 19.0017 33.4963C19.2932 33.4993 19.5811 33.5603 19.8487 33.6758C20.1163 33.7912 20.3583 33.9587 20.5605 34.1686L27.2228 40.8458C27.6364 41.261 27.8683 41.8235 27.8675 42.4096C27.8666 42.9957 27.6332 43.5576 27.2184 43.9717C26.795 44.368 26.2379 44.5906 25.658 44.595Z" fill="#E3E5E6" />
                        </svg>

                    </div>
                    <div className='w-1/2'>
                        <h6 className='text-sm font-bold whitespace-nowrap'>Total Bookings - YTD</h6>
                        <h3 className='text-5xl font-semibold mt-4'>{data.totalBookingsYTD}</h3>
                    </div>
                    <div className='flex flex-end' onClick={() => { window.location.href = '/bookings' }}>
                        <span className='ml-auto mr-0 text-xs text-sky-800 underline font-bold cursor-pointer hover:no-underline'>View</span>
                    </div>
                </div>
                <div className="p-6 relative w-full md:w-1/2 lg:w-1/4">
                    <div className='absolute inset-1 bg-zinc-100 -z-20 rounded-md'></div>
                    <div className='absolute right-4 pr-2 -z-10'>
                        <svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M42.4767 18.486V12.5068C42.4834 9.21981 41.1923 6.0631 38.8842 3.72288C36.5761 1.38266 33.4375 0.0481349 30.1508 0.00941915C30.1018 0 30.0528 0 30.0057 0H29.9907C26.6833 0.00446477 23.5123 1.31862 21.1713 3.65501C18.8303 5.99139 17.5099 9.15981 17.499 12.4672V18.5162C15.4428 21.2318 14.3325 24.546 14.3379 27.9523V44.3416C14.3389 48.4948 15.9895 52.4776 18.9266 55.414C21.8637 58.3504 25.8469 60 30.0001 60C34.1539 60 38.1377 58.3499 41.0749 55.4127C44.0121 52.4754 45.6622 48.4917 45.6622 44.3378V27.9485C45.6671 24.5303 44.5477 21.2054 42.4767 18.486ZM29.8795 2.27943C29.9258 2.28496 29.9723 2.2881 30.0189 2.28885C31.3577 2.29157 32.6828 2.55799 33.9186 3.07289C35.1544 3.58778 36.2767 4.34108 37.2213 5.28975C38.166 6.23842 38.9145 7.36388 39.4242 8.60186C39.9338 9.83984 40.1946 11.1661 40.1916 12.5049V16.0728C37.3585 13.6295 33.7413 12.2863 30.0001 12.2882C26.2461 12.2844 22.6168 13.6349 19.7784 16.0917V12.4728C19.7905 9.78903 20.8557 7.21724 22.7448 5.31087C24.6339 3.4045 27.1959 2.31594 29.8795 2.27943ZM43.0117 44.3378C43.0117 47.7887 41.6408 51.0983 39.2007 53.5384C36.7605 55.9786 33.451 57.3495 30.0001 57.3495C26.5492 57.3495 23.2396 55.9786 20.7995 53.5384C18.3593 51.0983 16.9885 47.7887 16.9885 44.3378V27.9485C16.9885 24.4976 18.3593 21.1881 20.7995 18.7479C23.2396 16.3078 26.5492 14.9369 30.0001 14.9369C33.451 14.9369 36.7605 16.3078 39.2007 18.7479C41.6408 21.1881 43.0117 24.4976 43.0117 27.9485V44.3378Z" fill="#E3E5E6" />
                            <path d="M21.5684 25.3002H24.9367C25.1849 25.2892 25.4192 25.1829 25.591 25.0034C25.7627 24.8239 25.8586 24.5851 25.8586 24.3366C25.8586 24.0882 25.7627 23.8494 25.591 23.6698C25.4192 23.4903 25.1849 23.384 24.9367 23.373H21.5684C21.3202 23.384 21.0858 23.4903 20.9141 23.6698C20.7423 23.8494 20.6465 24.0882 20.6465 24.3366C20.6465 24.5851 20.7423 24.8239 20.9141 25.0034C21.0858 25.1829 21.3202 25.2892 21.5684 25.3002Z" fill="#E3E5E6" />
                            <path d="M38.4308 23.373H35.0625C34.8143 23.384 34.58 23.4903 34.4082 23.6698C34.2365 23.8493 34.1406 24.0882 34.1406 24.3366C34.1406 24.585 34.2365 24.8239 34.4082 25.0034C34.58 25.1829 34.8143 25.2892 35.0625 25.3002H38.4308C38.5609 25.3059 38.6909 25.2853 38.8128 25.2394C38.9347 25.1936 39.0461 25.1236 39.1402 25.0335C39.2343 24.9435 39.3092 24.8353 39.3604 24.7155C39.4116 24.5957 39.438 24.4668 39.438 24.3366C39.438 24.2063 39.4116 24.0774 39.3604 23.9577C39.3092 23.8379 39.2343 23.7297 39.1402 23.6397C39.0461 23.5496 38.9347 23.4796 38.8128 23.4337C38.6909 23.3879 38.5609 23.3673 38.4308 23.373Z" fill="#E3E5E6" />
                            <path d="M21.5684 30.1205H24.9367C25.1849 30.1095 25.4192 30.0032 25.591 29.8237C25.7627 29.6442 25.8586 29.4054 25.8586 29.1569C25.8586 28.9085 25.7627 28.6697 25.591 28.4902C25.4192 28.3107 25.1849 28.2043 24.9367 28.1934H21.5684C21.3202 28.2043 21.0858 28.3107 20.9141 28.4902C20.7423 28.6697 20.6465 28.9085 20.6465 29.1569C20.6465 29.4054 20.7423 29.6442 20.9141 29.8237C21.0858 30.0032 21.3202 30.1095 21.5684 30.1205Z" fill="#E3E5E6" />
                            <path d="M28.3138 30.1205H31.6821C31.8122 30.1262 31.9421 30.1056 32.0641 30.0598C32.186 30.0139 32.2974 29.9439 32.3915 29.8538C32.4856 29.7638 32.5605 29.6556 32.6117 29.5358C32.6628 29.4161 32.6892 29.2872 32.6892 29.1569C32.6892 29.0267 32.6628 28.8978 32.6117 28.778C32.5605 28.6582 32.4856 28.55 32.3915 28.46C32.2974 28.3699 32.186 28.2999 32.0641 28.2541C31.9421 28.2082 31.8122 28.1876 31.6821 28.1933H28.3138C28.1837 28.1876 28.0537 28.2082 27.9318 28.2541C27.8099 28.2999 27.6985 28.3699 27.6044 28.46C27.5103 28.55 27.4354 28.6582 27.3842 28.778C27.333 28.8978 27.3066 29.0267 27.3066 29.1569C27.3066 29.2872 27.333 29.4161 27.3842 29.5358C27.4354 29.6556 27.5103 29.7638 27.6044 29.8538C27.6985 29.9439 27.8099 30.0139 27.9318 30.0598C28.0537 30.1056 28.1837 30.1262 28.3138 30.1205Z" fill="#E3E5E6" />
                            <path d="M38.4301 30.1205C38.5602 30.1262 38.6902 30.1056 38.8121 30.0598C38.934 30.0139 39.0454 29.9439 39.1395 29.8538C39.2336 29.7638 39.3085 29.6556 39.3597 29.5358C39.4109 29.4161 39.4372 29.2872 39.4372 29.1569C39.4372 29.0267 39.4109 28.8978 39.3597 28.778C39.3085 28.6582 39.2336 28.55 39.1395 28.46C39.0454 28.3699 38.934 28.2999 38.8121 28.2541C38.6902 28.2082 38.5602 28.1876 38.4301 28.1933H35.0618C34.9317 28.1876 34.8018 28.2082 34.6798 28.2541C34.5579 28.2999 34.4465 28.3699 34.3524 28.46C34.2583 28.55 34.1834 28.6582 34.1322 28.778C34.0811 28.8978 34.0547 29.0267 34.0547 29.1569C34.0547 29.2872 34.0811 29.4161 34.1322 29.5358C34.1834 29.6556 34.2583 29.7638 34.3524 29.8538C34.4465 29.9439 34.5579 30.0139 34.6798 30.0598C34.8018 30.1056 34.9317 30.1262 35.0618 30.1205H38.4301Z" fill="#E3E5E6" />
                            <path d="M28.3138 25.3002H31.6821C31.9302 25.2892 32.1646 25.1829 32.3364 25.0034C32.5081 24.8239 32.604 24.585 32.604 24.3366C32.604 24.0882 32.5081 23.8493 32.3364 23.6698C32.1646 23.4903 31.9302 23.384 31.6821 23.373H28.3138C28.1837 23.3673 28.0537 23.3879 27.9318 23.4337C27.8099 23.4796 27.6985 23.5496 27.6044 23.6397C27.5103 23.7297 27.4354 23.8379 27.3842 23.9577C27.333 24.0774 27.3066 24.2063 27.3066 24.3366C27.3066 24.4668 27.333 24.5957 27.3842 24.7155C27.4354 24.8353 27.5103 24.9435 27.6044 25.0335C27.6985 25.1236 27.8099 25.1936 27.9318 25.2394C28.0537 25.2853 28.1837 25.3059 28.3138 25.3002Z" fill="#E3E5E6" />
                            <path d="M30.0037 33.6152C27.7876 33.6145 25.621 34.2709 23.7779 35.5015C21.9348 36.7321 20.4981 38.4816 19.6493 40.5288C18.8005 42.576 18.5779 44.8289 19.0095 47.0026C19.4411 49.1763 20.5076 51.1732 22.0741 52.7407C23.6407 54.3083 25.6368 55.3762 27.8103 55.8092C29.9837 56.2423 32.2367 56.0212 34.2844 55.1738C36.3322 54.3264 38.0826 52.8908 39.3145 51.0486C40.5463 49.2063 41.2042 47.0402 41.205 44.824C41.2025 41.8533 40.0218 39.0049 37.9219 36.9036C35.822 34.8023 32.9744 33.6197 30.0037 33.6152ZM36.3259 43.4319L29.578 50.1798C29.4439 50.3142 29.2846 50.4209 29.1093 50.4937C28.9339 50.5665 28.7459 50.604 28.556 50.604C28.3661 50.604 28.1781 50.5665 28.0027 50.4937C27.8274 50.4209 27.6681 50.3142 27.534 50.1798L24.1638 46.8058C24.0296 46.6716 23.9232 46.5123 23.8505 46.3369C23.7779 46.1616 23.7405 45.9736 23.7405 45.7838C23.7405 45.594 23.7779 45.4061 23.8505 45.2307C23.9232 45.0554 24.0296 44.8961 24.1638 44.7619C24.2981 44.6277 24.4574 44.5212 24.6327 44.4486C24.8081 44.3759 24.996 44.3385 25.1858 44.3385C25.3756 44.3385 25.5636 44.3759 25.7389 44.4486C25.9143 44.5212 26.0736 44.6277 26.2078 44.7619L28.5588 47.1129L34.2838 41.3879C34.418 41.2537 34.5773 41.1472 34.7527 41.0746C34.928 41.002 35.116 40.9646 35.3058 40.9646C35.4956 40.9646 35.6835 41.002 35.8589 41.0746C36.0342 41.1472 36.1935 41.2537 36.3277 41.3879C36.4619 41.5221 36.5684 41.6815 36.641 41.8568C36.7137 42.0322 36.7511 42.2201 36.7511 42.4099C36.7511 42.5997 36.7137 42.7876 36.641 42.963C36.5684 43.1383 36.4601 43.2977 36.3259 43.4319Z" fill="#E3E5E6" />
                        </svg>

                    </div>
                    <div className='w-1/2'>
                        <h6 className='text-sm font-bold whitespace-nowrap'>Bookings Last Quarter</h6>
                        <h3 className='text-5xl font-semibold mt-4'>{data.bookingLastQuarter}</h3>
                    </div>
                    <div className='flex flex-end' onClick={() => { window.location.href = '/bookings' }}>
                        <span className='ml-auto mr-0 text-xs text-sky-800 underline font-bold cursor-pointer hover:no-underline'>View</span>
                    </div>
                </div>
                <div className="p-6 relative w-full md:w-1/2 lg:w-1/4">
                    <div className='absolute inset-1 bg-zinc-100 -z-20 rounded-md'></div>
                    <div className='absolute right-4 pr-2 -z-10'>
                        <svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M42.4768 18.4849V12.506C42.4835 9.21891 41.1923 6.06212 38.8839 3.72199C36.5755 1.38187 33.4366 0.0476392 30.1498 0.00941856C30.1008 0.00941856 30.0537 0 30.0047 0H29.9897C26.6832 0.00496619 23.5132 1.31938 21.1734 3.65567C18.8336 5.99196 17.5144 9.15991 17.5044 12.4664V18.515C15.4446 21.2288 14.3322 24.5435 14.3379 27.9505V44.3388C14.3379 48.4924 15.9879 52.4759 18.925 55.4129C21.862 58.35 25.8455 60 29.9991 60C34.1527 60 38.1362 58.35 41.0732 55.4129C44.0103 52.4759 45.6603 48.4924 45.6603 44.3388V27.9505C45.6665 24.5315 44.5478 21.2053 42.4768 18.4849ZM29.8804 2.28494C29.9267 2.29047 29.9732 2.29361 30.0198 2.29436C31.3585 2.29708 32.6836 2.56348 33.9193 3.07834C35.155 3.59321 36.2772 4.34646 37.2218 5.29507C38.1664 6.24368 38.9149 7.36907 39.4245 8.60697C39.9341 9.84487 40.1948 11.171 40.1919 12.5097V16.0718C37.3572 13.628 33.738 12.2855 29.9953 12.2893C26.2418 12.285 22.6128 13.6347 19.7743 16.0907V12.4721C19.7864 9.78778 20.8521 7.21559 22.7419 5.30923C24.6317 3.40288 27.1945 2.31482 29.8785 2.27929L29.8804 2.28494ZM43.0118 44.3407C43.0118 47.7914 41.641 51.1007 39.201 53.5407C36.761 55.9807 33.4517 57.3515 30.001 57.3515C26.5503 57.3515 23.241 55.9807 20.801 53.5407C18.361 51.1007 16.9902 47.7914 16.9902 44.3407V27.9524C16.9902 24.5017 18.361 21.1924 20.801 18.7524C23.241 16.3124 26.5503 14.9416 30.001 14.9416C33.4517 14.9416 36.761 16.3124 39.201 18.7524C41.641 21.1924 43.0118 24.5017 43.0118 27.9524V44.3407Z" fill="#E3E5E6" />
                            <path d="M21.5693 25.2981H24.9374C25.1856 25.2871 25.42 25.1808 25.5917 25.0013C25.7634 24.8218 25.8593 24.583 25.8593 24.3346C25.8593 24.0862 25.7634 23.8473 25.5917 23.6678C25.42 23.4883 25.1856 23.382 24.9374 23.3711H21.5637C21.4336 23.3653 21.3037 23.386 21.1817 23.4318C21.0598 23.4776 20.9485 23.5477 20.8544 23.6377C20.7603 23.7277 20.6854 23.8359 20.6342 23.9557C20.583 24.0754 20.5566 24.2043 20.5566 24.3346C20.5566 24.4648 20.583 24.5937 20.6342 24.7135C20.6854 24.8333 20.7603 24.9414 20.8544 25.0315C20.9485 25.1215 21.0598 25.1915 21.1817 25.2374C21.3037 25.2832 21.4336 25.3038 21.5637 25.2981H21.5693Z" fill="#E3E5E6" />
                            <path d="M38.4296 23.3711H35.0559C34.9258 23.3653 34.7958 23.386 34.6739 23.4318C34.552 23.4776 34.4407 23.5477 34.3465 23.6377C34.2524 23.7277 34.1775 23.8359 34.1264 23.9557C34.0752 24.0754 34.0488 24.2043 34.0488 24.3346C34.0488 24.4648 34.0752 24.5937 34.1264 24.7135C34.1775 24.8333 34.2524 24.9414 34.3465 25.0315C34.4407 25.1215 34.552 25.1915 34.6739 25.2374C34.7958 25.2832 34.9258 25.3038 35.0559 25.2981H38.4296C38.6778 25.2871 38.9122 25.1808 39.0839 25.0013C39.2556 24.8218 39.3515 24.583 39.3515 24.3346C39.3515 24.0862 39.2556 23.8473 39.0839 23.6678C38.9122 23.4883 38.6778 23.382 38.4296 23.3711Z" fill="#E3E5E6" />
                            <path d="M21.5693 30.1184H24.9374C25.1856 30.1074 25.42 30.0011 25.5917 29.8216C25.7634 29.6421 25.8593 29.4033 25.8593 29.1549C25.8593 28.9065 25.7634 28.6676 25.5917 28.4882C25.42 28.3087 25.1856 28.2023 24.9374 28.1914H21.5637C21.4336 28.1856 21.3037 28.2063 21.1817 28.2521C21.0598 28.2979 20.9485 28.368 20.8544 28.458C20.7603 28.548 20.6854 28.6562 20.6342 28.776C20.583 28.8958 20.5566 29.0247 20.5566 29.1549C20.5566 29.2851 20.583 29.414 20.6342 29.5338C20.6854 29.6536 20.7603 29.7617 20.8544 29.8518C20.9485 29.9418 21.0598 30.0119 21.1817 30.0577C21.3037 30.1035 21.4336 30.1242 21.5637 30.1184H21.5693Z" fill="#E3E5E6" />
                            <path d="M28.3142 30.1184H31.6823C31.9305 30.1075 32.1648 30.0012 32.3366 29.8217C32.5083 29.6422 32.6041 29.4033 32.6041 29.1549C32.6041 28.9065 32.5083 28.6677 32.3366 28.4882C32.1648 28.3087 31.9305 28.2024 31.6823 28.1914H28.3086C28.0604 28.2024 27.826 28.3087 27.6543 28.4882C27.4826 28.6677 27.3867 28.9065 27.3867 29.1549C27.3867 29.4033 27.4826 29.6422 27.6543 29.8217C27.826 30.0012 28.0604 30.1075 28.3086 30.1184H28.3142Z" fill="#E3E5E6" />
                            <path d="M38.4296 30.1184C38.6778 30.1074 38.9122 30.0011 39.0839 29.8216C39.2556 29.6421 39.3515 29.4033 39.3515 29.1549C39.3515 28.9065 39.2556 28.6676 39.0839 28.4882C38.9122 28.3087 38.6778 28.2023 38.4296 28.1914H35.0559C34.9258 28.1856 34.7958 28.2063 34.6739 28.2521C34.552 28.2979 34.4407 28.368 34.3465 28.458C34.2524 28.548 34.1775 28.6562 34.1264 28.776C34.0752 28.8958 34.0488 29.0247 34.0488 29.1549C34.0488 29.2851 34.0752 29.414 34.1264 29.5338C34.1775 29.6536 34.2524 29.7617 34.3465 29.8518C34.4407 29.9418 34.552 30.0119 34.6739 30.0577C34.7958 30.1035 34.9258 30.1242 35.0559 30.1184H38.4296Z" fill="#E3E5E6" />
                            <path d="M28.3142 25.2981H31.6823C31.9305 25.2872 32.1648 25.1808 32.3366 25.0014C32.5083 24.8219 32.6041 24.583 32.6041 24.3346C32.6041 24.0862 32.5083 23.8474 32.3366 23.6679C32.1648 23.4884 31.9305 23.3821 31.6823 23.3711H28.3086C28.0604 23.3821 27.826 23.4884 27.6543 23.6679C27.4826 23.8474 27.3867 24.0862 27.3867 24.3346C27.3867 24.583 27.4826 24.8219 27.6543 25.0014C27.826 25.1808 28.0604 25.2872 28.3086 25.2981H28.3142Z" fill="#E3E5E6" />
                            <path d="M30.0031 33.6133C27.7871 33.6133 25.6209 34.2704 23.7784 35.5015C21.9358 36.7327 20.4997 38.4826 19.6517 40.5299C18.8037 42.5772 18.5818 44.83 19.0141 47.0035C19.4464 49.1769 20.5135 51.1733 22.0805 52.7402C23.6475 54.3072 25.6439 55.3743 27.8173 55.8066C29.9907 56.2389 32.2435 56.0171 34.2909 55.169C36.3382 54.321 38.0881 52.8849 39.3192 51.0424C40.5504 49.1998 41.2075 47.0336 41.2075 44.8176C41.204 41.8471 40.0224 38.9993 37.9219 36.8988C35.8215 34.7984 32.9736 33.6168 30.0031 33.6133ZM30.0031 53.4921C28.2894 53.4921 26.6141 52.9839 25.1891 52.0318C23.7641 51.0796 22.6535 49.7263 21.9977 48.143C21.3418 46.5597 21.1702 44.8174 21.5046 43.1366C21.8389 41.4557 22.6642 39.9117 23.876 38.6999C25.0879 37.4881 26.6318 36.6628 28.3127 36.3284C29.9935 35.9941 31.7358 36.1657 33.3191 36.8215C34.9025 37.4774 36.2558 38.588 37.2079 40.013C38.16 41.4379 38.6682 43.1132 38.6682 44.827C38.6628 47.1229 37.7479 49.3232 36.1239 50.9461C34.4999 52.569 32.2991 53.4825 30.0031 53.4865V53.4921Z" fill="#E3E5E6" />
                        </svg>
                    </div>
                    <div className='w-1/2'>
                        <h6 className='text-sm font-bold whitespace-nowrap'>Bookings Last Month</h6>
                        <h3 className='text-5xl font-semibold mt-4'>{data.bookingsLastMonth}</h3>
                    </div>
                    <div className='flex flex-end' onClick={() => { window.location.href = '/bookings' }}>
                        <span className='ml-auto mr-0 text-xs text-sky-800 underline font-bold cursor-pointer hover:no-underline'>View</span>
                    </div>
                </div>
                <div className="p-6 relative w-full md:w-1/2 lg:w-1/4">
                    <div className='absolute inset-1 bg-zinc-100 -z-20 rounded-md'></div>
                    <div className='absolute right-4 pr-2 -z-10'>
                        <svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fillRule="evenodd" clipRule="evenodd" d="M54.6848 26.4771L29.8543 9.40257C29.7191 9.31995 29.5626 9.27865 29.4042 9.2836C29.2466 9.28067 29.0914 9.32184 28.956 9.40257L4.1255 26.4771C3.96628 26.601 3.85754 26.7785 3.81955 26.9766C3.78157 27.1747 3.81695 27.38 3.91906 27.554L4.94201 29.0028C5.06089 29.1692 5.23925 29.2836 5.44009 29.322C5.64094 29.3604 5.8489 29.3201 6.02082 29.2094L9.84303 26.5682V41.686C9.84048 41.8805 9.91419 42.0681 10.0484 42.2089C10.1826 42.3497 10.3666 42.4323 10.5609 42.4391H12.3744C12.5692 42.4417 12.7572 42.3678 12.8981 42.2332C13.039 42.0986 13.1214 41.9141 13.1277 41.7194V25.002C13.1239 24.7865 13.1765 24.574 13.2803 24.3851C13.384 24.1962 13.5353 24.0375 13.7192 23.9251L28.6286 13.6377C28.6675 13.6019 28.7099 13.5703 28.7551 13.543C28.9499 13.4263 29.1735 13.3664 29.4005 13.37C29.6283 13.3656 29.8526 13.4256 30.0478 13.543C30.0923 13.5713 30.1346 13.6028 30.1743 13.6377L45.0837 23.9251C45.2672 24.0379 45.4182 24.1965 45.5219 24.3853C45.6256 24.5741 45.6784 24.7866 45.6752 25.002V41.7194C45.6815 41.9141 45.7639 42.0986 45.9048 42.2332C46.0456 42.3678 46.2337 42.4417 46.4285 42.4391H48.2401C48.4348 42.4328 48.6192 42.3504 48.7538 42.2096C48.8884 42.0687 48.9624 41.8808 48.9599 41.686V26.5682L52.7821 29.2094C52.9537 29.32 53.1614 29.3602 53.3619 29.3218C53.5624 29.2833 53.7405 29.169 53.859 29.0028L54.882 27.554C54.9855 27.3812 55.0226 27.1766 54.9863 26.9784C54.95 26.7803 54.8429 26.6021 54.6848 26.4771ZM29.3848 36.6214C29.5376 36.6918 29.7038 36.7286 29.8721 36.7292C30.0914 36.7282 30.306 36.6653 30.4913 36.5478C30.6765 36.4304 30.8248 36.2631 30.9192 36.0651C30.9836 35.928 31.0201 35.7794 31.0265 35.6281C31.0328 35.4767 31.0091 35.3256 30.9565 35.1835C30.9053 35.0408 30.8264 34.9096 30.7242 34.7975C30.622 34.6855 30.4987 34.5948 30.3613 34.5307C30.2887 34.4973 30.2181 34.4656 30.1455 34.434C30.8708 33.8331 31.4557 33.0804 31.859 32.2292C32.2623 31.378 32.4742 30.4488 32.4798 29.5069C32.4744 27.8177 31.8008 26.1993 30.6062 25.005C29.4116 23.8108 27.793 23.1377 26.1038 23.1328C24.4147 23.1372 22.796 23.8102 21.6016 25.0046C20.4071 26.199 19.7342 27.8177 19.7297 29.5069C19.7328 30.4626 19.9495 31.4057 20.364 32.2669C20.7785 33.128 21.3803 33.8856 22.1254 34.4842C19.7779 35.5544 17.9436 37.5023 17.0161 39.9097C16.9101 40.1953 16.9203 40.5111 17.0444 40.7893C17.1685 41.0674 17.3968 41.2859 17.6801 41.3978C17.8118 41.4461 17.9509 41.4711 18.0911 41.472C18.3241 41.4705 18.5512 41.3988 18.7427 41.2661C18.9342 41.1333 19.0812 40.9456 19.1643 40.728C19.8824 38.8634 21.3114 37.3603 23.1372 36.5487C24.0971 36.1184 25.1374 35.8966 26.1894 35.8978C27.1165 35.8978 28.0355 36.0704 28.8993 36.4073C28.9249 36.4185 28.9503 36.4295 28.9757 36.4405C28.9996 36.4509 29.0233 36.4611 29.047 36.4713C29.1614 36.5207 29.274 36.5693 29.3848 36.6214ZM30.1716 29.5051C30.1672 30.5817 29.7376 31.613 28.9765 32.3745C28.2153 33.136 27.1842 33.5661 26.1076 33.571C25.0317 33.5642 24.0017 33.1338 23.2407 32.3731C22.4797 31.6125 22.049 30.5828 22.0417 29.5069C22.048 28.4303 22.4783 27.3996 23.2394 26.6382C24.0005 25.8768 25.031 25.446 26.1076 25.4391C27.1835 25.4465 28.2132 25.8772 28.9738 26.6382C29.7344 27.3991 30.1648 28.4292 30.1716 29.5051ZM40.5042 43.0045C42.2199 43.8799 43.55 45.3604 44.2372 47.1597C44.3212 47.3839 44.3336 47.6286 44.2726 47.8601C44.2117 48.0917 44.0803 48.2988 43.8968 48.4525L44.0586 48.6923L43.376 48.7241H43.1528C42.9198 48.7219 42.6927 48.6499 42.501 48.5172C42.3094 48.3846 42.1619 48.1974 42.0778 47.98C41.806 47.2656 41.3868 46.6165 40.8475 46.0749C40.3081 45.5333 39.6607 45.1113 38.9475 44.8366C38.3258 44.5988 37.6657 44.4777 37.0001 44.4794C36.2409 44.4793 35.49 44.6386 34.796 44.9465C33.4832 45.5313 32.4558 46.6128 31.9392 47.9539C31.8542 48.1707 31.7065 48.3572 31.515 48.4897C31.3236 48.6223 31.0969 48.6948 30.8641 48.6979C30.7232 48.6972 30.5834 48.672 30.4511 48.6235C30.1669 48.5128 29.9378 48.2945 29.8135 48.0159C29.6892 47.7373 29.6797 47.4211 29.7872 47.1356C30.4655 45.3812 31.7576 43.9324 33.4234 43.0586C32.9176 42.5801 32.5149 42.0033 32.2398 41.3637C31.9648 40.724 31.8232 40.0349 31.8238 39.3387C31.8282 37.9836 32.3686 36.6852 33.3269 35.7273C34.2852 34.7693 35.5837 34.2295 36.9387 34.2256C38.2944 34.2295 39.5935 34.7694 40.5525 35.7277C41.5115 36.686 42.0524 37.9848 42.0573 39.3405C42.0556 40.0239 41.9173 40.6999 41.6506 41.3292C41.3839 41.9584 40.9941 42.528 40.5042 43.0045ZM36.7974 36.1655L36.8141 36.5376H36.8215C36.0988 36.5683 35.4159 36.8769 34.9154 37.3992C34.4149 37.9215 34.1356 38.6171 34.1358 39.3405C34.1372 40.0851 34.4336 40.7989 34.9599 41.3255C35.4862 41.8522 36.1997 42.1489 36.9443 42.1509C37.6887 42.1489 38.402 41.852 38.9281 41.3253C39.4541 40.7986 39.75 40.0849 39.7509 39.3405C39.7485 38.5966 39.4514 37.8839 38.9247 37.3586C38.3979 36.8333 37.6845 36.5381 36.9406 36.5376L36.7974 36.1655Z" fill="#E3E5E6" />
                        </svg>
                    </div>
                    <div className='w-1/2'>
                        <h6 className='text-sm font-bold whitespace-nowrap'>Canceled Bookings - YTD</h6>
                        <h3 className='text-5xl font-semibold mt-4'>{data.bookingsCanceledYTD}</h3>
                    </div>
                    <div className='flex flex-end' onClick={() => { window.location.href = '/bookings' }}>
                        <span className='ml-auto mr-0 text-xs text-sky-800 underline font-bold cursor-pointer hover:no-underline'>View</span>
                    </div>
                </div>
            </div>
            <div className='flex justify-end py-4 mr-2'>
                <SelectFilterComponent options={filters} placeholder={"Filter"} onChange={handleFilterSelection} value={filterSelection} />
            </div>
            <div className='flex flex-wrap'>
                <div className='bg-zinc-100 w-full py-8 px-6 relative border-8 border-white rounded-md'>
                    <h6 className='text-sm font-bold whitespace-nowrap'>Bookings compared to previous</h6>
                    <div className='p-4 h-96 relative'>
                        <Line data={lineChartData} options={lineChartOptions} />
                    </div>
                </div>
                <div className='flex w-full flex-wrap'>
                    <div className='bg-zinc-100 w-full lg:w-1/3 p-6 border-8 border-white rounded-lg'>
                        <h6 className='text-sm font-bold whitespace-nowrap'>Total Leads vs Lead Time</h6>
                        <div className='flex justify-center items-center p-6'>
                            <div className='w-32 h-32'>
                                <Doughnut data={pieChartData} options={pieChartOptions} />
                            </div>
                        </div>
                        <div className='bg-[#02ab92] bg-opacity-10 mt-2 p-2 rounded-full flex justify-between text-xs font-bold text-[#02ab92]'>
                            <p>0 - 19 Days</p>
                            <p>{data.leads.zero19}</p>
                        </div>
                        <div className='bg-[#0288d1] bg-opacity-10 mt-2 p-2 rounded-full flex justify-between text-xs font-bold text-[#0288d1]'>
                            <p>20 - 39 Days</p>
                            <p>{data.leads.twenty39}</p>
                        </div>
                        <div className='bg-[#ffbb00] bg-opacity-10 mt-2 p-2 rounded-full flex justify-between text-xs font-bold text-[#FFBB00]'>
                            <p>40 - 59 Days</p>
                            <p>{data.leads.fourty59}</p>
                        </div>
                        <div className='bg-[#ff5d5d] bg-opacity-10 mt-2 p-2 rounded-full flex justify-between text-xs font-bold text-[#FF5D5D]'>
                            <p>60+ Days</p>
                            <p>{data.leads.sixtyPlus}</p>
                        </div>
                    </div>
                    <div className='bg-zinc-100 w-full lg:w-[66.60%] p-2 md:p-6 border-8 border-white rounded-lg'>
                        <h6 className='text-sm font-bold whitespace-nowrap'>Enquires vs Eligibility vs Bookings</h6>
                        <div className='p-6 h-96 relative'>
                            <Bar options={barCharOptions} data={barChartData} />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    )
}

export default forwardRef(AdminDashboardPage);